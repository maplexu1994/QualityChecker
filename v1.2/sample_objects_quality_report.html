<!doctype html>
    <html lang="zh-CN">
    <head>
    <meta charset="utf-8" />
    <title>JSON→XODR 质检报告</title>
    <style>
      html,body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans CJK SC", "Microsoft YaHei", "PingFang SC", sans-serif; color:#222; }
      .container { max-width: 1100px; margin: 32px auto; padding: 0 16px; }
      h1 { font-size: 26px; margin: 0 0 6px; }
      h2 { font-size: 20px; margin: 28px 0 12px; border-left:4px solid #555; padding-left:8px; }
      h3 { font-size: 16px; margin: 18px 0 10px; }
      .meta, .muted { color:#666; font-size: 13px; }
      .grid { display:grid; grid-template-columns: repeat(3,1fr); gap:12px; }
      .card { border:1px solid #e6e6e6; border-radius:10px; padding:12px 14px; background:#fff; }
      .kpi { font-size: 22px; font-weight:600; }
      .ok { color:#138000; }
      .warn { color:#d97706; }
      .bad { color:#b91c1c; }
      table { width:100%; border-collapse: collapse; }
      th, td { border-bottom:1px solid #eee; padding:8px 10px; text-align:left; }
      th { background:#fafafa; }
      td.num, th.num { text-align:right; }
      .imgwrap { text-align:center; margin: 14px 0 6px; }
      .warning-list { margin:6px 0 0 16px; }
      .tag { display:inline-block; padding:2px 6px; border-radius:6px; background:#f2f2f2; font-size:12px; margin-left:6px; }
      .legend { color:#555; font-size: 13px; }
      .footer { color:#777; font-size: 12px; margin-top: 28px; }
    </style>
    </head>
    <body>
    <div class="container">

      <h1>JSON → XODR 质检报告</h1>
      <div class="meta">生成时间：2025-08-27 16:33:42</div>
      <div class="meta">JSON 文件：sample_objects.json</div>
      <div class="meta">XODR 文件：sample_objects.xodr</div>

      <h2>摘要</h2>
      <div class="grid">
        <div class="card">
          <div class="muted">完整性得分</div>
          <div class="kpi">100.0%</div>
          <div class="legend">依据：车道/边界/物体/标识的数量对比</div>
        </div>
        <div class="card">
          <div class="muted">一致性得分</div>
          <div class="kpi">98.8%</div>
          <div class="legend">依据：仅以 JSON 边界点到 XODR（参考线+车道边界）最近距离的平均偏移与阈值（0.100 m）比较</div>
        </div>
        <div class="card">
          <div class="muted">告警数量</div>
          <div class="kpi ok">0</div>
          <div class="legend">超阈值点：0/33</div>
        </div>
      </div>

      <h2>完整性检查</h2>
      <div class="card">
        <table>
          <thead>
            <tr><th>要素</th><th class="num">JSON 数量</th><th class="num">XODR 数量</th><th class="num">子分数</th></tr>
          </thead>
          <tbody>
            <tr><td>车道（driving）</td><td class="num">8</td><td class="num">13</td><td class="num">1.00</td></tr>
            <tr><td>边界（唯一ID vs 拓扑边界）</td><td class="num">11</td><td class="num">13</td><td class="num">1.00</td></tr>
            <tr><td>标识（sign → signal）</td><td class="num">0</td><td class="num">0</td><td class="num">1.00</td></tr>
            <tr><td>物体（objects）</td><td class="num">4</td><td class="num">4</td><td class="num">1.00</td></tr>
          </tbody>
        </table>
        <div class="legend" style="margin-top:8px;">
          边界备注：唯一边界ID数 11；共有边界 5 个（ID: [2, 3, 6, 7, 10]）
        </div>
        <div class="muted" style="margin-top:8px;">
            说明：XODR 的数量可能大于 JSON，这是因为 OpenDRIVE 会将车道、标线按段落或属性拆分；只要不少于 JSON 即视为完整。
        </div>
      </div>

      <h2>一致性检查</h2>
      <div class="grid">
        <div class="card">
          <div class="muted">平均偏移</div>
          <div class="kpi">0.001 m</div>
        </div>
        <div class="card">
          <div class="muted">最大 / 最小偏移</div>
          <div class="kpi">0.021 / 0.000 m</div>
        </div>
        <div class="card">
          <div class="muted">参与点数</div>
          <div class="kpi">33</div>
          <div class="legend">仅包含 JSON 中的边界点（objects 已忽略）</div>
        </div>
      </div>

      <div class="card">
        <div class="muted">可视化（分布 & 偏移热力）</div>
        <div class="imgwrap">
          <img src="sample_objects_visualization.png" alt="Visualization" style="max-width:100%;border:1px solid #eee;border-radius:8px;">
        </div>
        <div class="legend">左图：参考线 + 车道中心线/边界 + JSON 点；右图：仅边界点偏移着色</div>
      </div>

      <h2>匹配明细（前 200 条）<span class="tag">仅 JSON 边界点</span></h2>
      <div class="card">
        <table>
          <thead>
            <tr>
              <th class="num">序号</th>
              <th>类型</th>
              <th>JSON 坐标 (x, y)</th>
              <th>最近 XODR 坐标 (x, y)</th>
              <th class="num">偏移 (m)</th>
              <th>判定</th>
            </tr>
          </thead>
          <tbody>
            <tr><td class='num'>0</td><td>bound</td><td>(0.000, 10.500)</td><td>(0.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>1</td><td>bound</td><td>(-10.000, 10.500)</td><td>(-10.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>2</td><td>bound</td><td>(-50.000, 10.500)</td><td>(-50.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>3</td><td>bound</td><td>(-50.000, 7.000)</td><td>(-50.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>4</td><td>bound</td><td>(-10.000, 7.000)</td><td>(-10.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>5</td><td>bound</td><td>(0.000, 7.000)</td><td>(0.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>6</td><td>bound</td><td>(-50.000, 3.500)</td><td>(-50.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>7</td><td>bound</td><td>(-10.000, 3.500)</td><td>(-10.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>8</td><td>bound</td><td>(0.000, 3.500)</td><td>(0.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>9</td><td>bound</td><td>(-50.000, 0.000)</td><td>(-50.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>10</td><td>bound</td><td>(-10.000, 0.000)</td><td>(-10.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>11</td><td>bound</td><td>(0.000, 0.000)</td><td>(0.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>12</td><td>bound</td><td>(0.000, 10.500)</td><td>(0.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>13</td><td>bound</td><td>(20.000, 10.500)</td><td>(20.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>14</td><td>bound</td><td>(40.000, 10.500)</td><td>(40.000, 10.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>15</td><td>bound</td><td>(0.000, 7.000)</td><td>(0.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>16</td><td>bound</td><td>(20.000, 7.000)</td><td>(20.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>17</td><td>bound</td><td>(40.000, 7.000)</td><td>(40.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>18</td><td>bound</td><td>(0.000, 3.500)</td><td>(0.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>19</td><td>bound</td><td>(20.000, 3.500)</td><td>(20.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>20</td><td>bound</td><td>(40.000, 3.500)</td><td>(40.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>21</td><td>bound</td><td>(0.000, 0.000)</td><td>(0.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>22</td><td>bound</td><td>(20.000, 0.000)</td><td>(20.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>23</td><td>bound</td><td>(40.000, 0.000)</td><td>(40.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>24</td><td>bound</td><td>(0.000, 7.000)</td><td>(0.000, 7.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>25</td><td>bound</td><td>(11.500, 5.200)</td><td>(11.500, 5.200)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>26</td><td>bound</td><td>(31.800, -6.000)</td><td>(31.800, -6.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>27</td><td>bound</td><td>(0.000, 3.500)</td><td>(0.000, 3.500)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>28</td><td>bound</td><td>(10.000, 2.000)</td><td>(10.021, 1.994)</td><td class='num'>0.021</td><td>✅ Pass</td></tr><tr><td class='num'>29</td><td>bound</td><td>(30.000, -9.000)</td><td>(29.999, -9.000)</td><td class='num'>0.001</td><td>✅ Pass</td></tr><tr><td class='num'>30</td><td>bound</td><td>(0.000, 0.000)</td><td>(0.000, 0.000)</td><td class='num'>0.000</td><td>✅ Pass</td></tr><tr><td class='num'>31</td><td>bound</td><td>(9.000, -1.200)</td><td>(9.017, -1.202)</td><td class='num'>0.017</td><td>✅ Pass</td></tr><tr><td class='num'>32</td><td>bound</td><td>(28.200, -12.000)</td><td>(28.199, -11.999)</td><td class='num'>0.002</td><td>✅ Pass</td></tr>
          </tbody>
        </table>
        <div class="muted">总计 33 条匹配记录；为避免过大，仅展示前 200 条。</div>
      </div>

      <h2>告警列表（超过阈值的点）</h2>
      <div class="card">
        <p class='muted'>无</p>
      </div>

      <div class="footer">
        阈值（横向距离）：0.100 m。<br/>
        注：一致性仅以 JSON 的边界点参与计算；JSON 中 objects 与道路无直接关系，已在统计和可视化中忽略。
      </div>

    </div>
    </body>
    </html>